seq = |0 0 1 0
part = rhook @ sbeat join
pulseA = part 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
pulseB = part 4 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0
pulse = kick (perbeat 4) * sbeats 16 $ sel seq |pulseA pulseB
hitA = part 4 0 0 0 1 0 0 1 0 0 1 0 0 1 0 0 0
hitB = part 4 0 0 0 1 0 0 1 0 1 1 1 1 1 0 0 0
hit = noise * max 0 (saw (perbeat 4)) * sbeats 16 $ sel seq |hitA hitB
hhA = part 8 1 0 1 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 1 0 1 0 1 0 1 0 1 0
hhB = part 8 $ join (16::0) 1 0 1 0 1 0 1 0 (8::1)
hh = 0.3 noise * max 0 (saw (perbeat 8)) * sbeats 16 $ sel seq |hhA hhB
bass = time > beats 32
notes = 0.5 sin [|(bass C2) C3 Eb4 G4 |(bass Eb2) Eb3 G4 Bb4 |(bass G2) G3 D4 B4 |(bass D2) D3 F4 Ab4]
offset_notes = rhook @ pan (flip @ sec notes (beats 4))
melody = offset_notes -1 0 + offset_notes 1 0.007
melody + (pulse + hit + hh) * sbeats 16 $ 8::1 :0 0
